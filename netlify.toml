
# https://docs.netlify.com/configure-builds/file-based-configuration/#sample-file
[build]
  publish = "_site/"
  # https://docs.netlify.com/configure-builds/file-based-configuration/#inject-environment-variable-values
  command = 'sed -i "s|HEADER_PLACEHOLDER|${AUTHORIZATION_HEADER_VALUE}|g" netlify.toml && npm run build'

# https://www.netlify.com/products/dev/
# https://github.com/netlify/cli/blob/master/docs/netlify-dev.md
[dev]
  publish    = "_site/"
  command    = "npm start"
  targetPort = 4000
  port       = 8888
  autoLaunch = true

# https://docs.netlify.com/routing/redirects/#syntax-for-the-netlify-configuration-file
[[redirects]]
  from = "/index/"
  to = "/recipes/"
  status = 302
  force = true
  # query = {path = ":path"}
  # conditions = {Language = ["en"], Country = ["US"], Role = ["admin"]}
  # headers = {X-From = "Netlify"}
  # signed = "API_SIGNATURE_TOKEN"

[[redirects]]
  from = "/wp-admin/*"
  to = "https://content.dollyskettle.com/wp-admin/:splat"
  status = 302

# https://docs.netlify.com/routing/redirects/rewrites-proxies/#proxy-to-another-service
[[redirects]]
  from = "/wp-content/uploads/*"
  to = "https://content.dollyskettle.com/wp-content/uploads/:splat"
  status = 200
  force = true
  headers = {Authorization = "HEADER_PLACEHOLDER"}
